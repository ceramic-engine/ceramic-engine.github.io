<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript">if (location.protocol !== 'https:' && location.hostname == 'ceramic-engine.com') location.replace('https:'+location.href.substring(location.protocol.length));</script>
        <meta charset="utf-8">
        <link rel="icon" href="/static/favicon.png"/>
        <link rel="apple-touch-icon" href="/static/touch-icon.png"/>
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <title>Events - Ceramic</title>
        <link rel="stylesheet" href="/static/style.css" type="text/css" />
        <link rel="stylesheet" href="/static/prism.css" type="text/css" />
        <script type="text/javascript" src="/static/script.js"></script>
        <meta property="og:site_name" content="Ceramic Engine" />
        <meta property="og:title" content="Events - Ceramic" />
        <meta property="og:description" content="A cross-platform &amp; open-source 2D framework" />
        <meta property="og:image" content="/static/img/ceramic-800-450.png" />
        <meta property="og:image:type" content="image/png" />
        <meta property="og:image:width" content="800" />
        <meta property="og:image:height" content="450" />
        
    </head>
    <body id="page-guides" class="page page-standard">
        <aside id="site-navigation">
            <ul>
                <li><a href="/"><img src="/static/ceramic-small.png" class="ceramic-icon" />Ceramic</a></li>
                <li class="selected"><a href="/guides">Guides</a></li>
                <li><a href="/examples">Examples</a></li>
                <li><a href="/blog">Blog</a></li>
                <li><a href="/api-docs">API Docs</a></li>
                <li><a href="https://github.com/ceramic-engine/ceramic">GitHub</a></li>
                <li><a href="/discord">Discord</a></li>
            </ul>
        </aside>
        
<div class="page-container">
    <div class="sidebar-left">
        
        <aside class="sidebar">
            <ul>
            
                
                <li class="menu-title">Introduction</li>
                <li class="">
                    <ul>
                        
                            <li>
                                <a href="/guides/discover-ceramic/">Discover Ceramic</a>
                            </li>
                        
                    </ul>
                </li>
            
                
                <li class="menu-title">Getting Started</li>
                <li class="">
                    <ul>
                        
                            <li>
                                <a href="/guides/install-ceramic/">Install Ceramic</a>
                            </li>
                        
                            <li>
                                <a href="/guides/your-first-project/">Your first Ceramic project</a>
                            </li>
                        
                            <li>
                                <a href="/guides/editing-your-project/">Editing your project</a>
                            </li>
                        
                            <li>
                                <a href="/guides/display-a-square/">Display a square</a>
                            </li>
                        
                            <li>
                                <a href="/guides/display-an-image/">Display an image</a>
                            </li>
                        
                            <li>
                                <a href="/guides/moving-visuals/">Moving visuals</a>
                            </li>
                        
                    </ul>
                </li>
            
                
                <li class="menu-title selected">Handbook</li>
                <li class="expanded">
                    <ul>
                        
                            <li>
                                <a href="/guides/entities/">Entities</a>
                            </li>
                        
                            <li class="selected">
                                <a href="/guides/events/">Events</a>
                            </li>
                        
                            <li>
                                <a href="/guides/visuals/">Visuals</a>
                            </li>
                        
                            <li>
                                <a href="/guides/components/">Components</a>
                            </li>
                        
                            <li>
                                <a href="/guides/text/">Text</a>
                            </li>
                        
                            <li>
                                <a href="/guides/audio/">Audio</a>
                            </li>
                        
                            <li>
                                <a href="/guides/assets/">Assets</a>
                            </li>
                        
                            <li>
                                <a href="/guides/scenes/">Scenes</a>
                            </li>
                        
                            <li>
                                <a href="/guides/filters/">Filters</a>
                            </li>
                        
                            <li>
                                <a href="/guides/state-machines/">State Machines</a>
                            </li>
                        
                            <li>
                                <a href="/guides/observables/">Observables</a>
                            </li>
                        
                            <li>
                                <a href="/guides/systems/">Systems</a>
                            </li>
                        
                    </ul>
                </li>
            
                
                <li class="menu-title">Appendices</li>
                <li class="">
                    <ul>
                        
                            <li>
                                <a href="/guides/inside-a-default-project/">Inside a default project</a>
                            </li>
                        
                            <li>
                                <a href="/guides/ceramic-via-git/">Ceramic via Git</a>
                            </li>
                        
                            <li>
                                <a href="/guides/platform-setup/">Platform Setup</a>
                            </li>
                        
                            <li>
                                <a href="/guides/ceramic-yml-reference/">Reference: ceramic.yml</a>
                            </li>
                        
                            <li>
                                <a href="/guides/defines/">Ceramic Defines</a>
                            </li>
                        
                    </ul>
                </li>
            
                
                <li class="menu-title">Extras</li>
                <li class="">
                    <ul>
                        
                            <li>
                                <a href="/guides/faq/">FAQ</a>
                            </li>
                        
                    </ul>
                </li>
            
            </ul>
        </aside>
        
    </div>
    <div class="content-right">
        <main>
            <h1>Events</h1>
<p>Every entity in Ceramic implements the <code>Events</code> interface, making it compatible with Ceramic <strong>events syntax</strong>.</p>
<h2 id="how-to-create-events" tabindex="-1">How to create events? <a class="header-anchor" href="#how-to-create-events"><span aria-hidden="true" class="header-anchor__symbol">#</span></a></h2>
<p>Let's imagin a silly example in a restaurant with a <code>kitchen</code> and a <code>waiter</code>. The waiter is waiting for the kitchen to have a dish ready to serve. When a dish is ready, we want the <code>kitchen</code> to fire the <code>dishReady</code> event so that the <code>waiter</code> can serve that dish.</p>
<p>In Ceramic, that can be done with classes that inherit from <code>Entity</code> and custom events. First, let's create a <code>Kitchen</code> entity class and add that <code>dishReady</code> event declaration inside:</p>
<div class="codename">Kitchen.hx</div>
<pre class="language-haxe"><code class="language-haxe"><span class="highlight-line"><span class="token keyword">import</span> ceramic<span class="token punctuation">.</span>Entity<span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token keyword">import</span> ceramic<span class="token punctuation">.</span>Timer<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token keyword">class</span> Kitchen <span class="token keyword">extends</span> Entity <span class="token punctuation">{</span></span>
<span class="highlight-line"></span>
    <span class="token comment">/**
<span class="highlight-line">     * A custom `dishReady` event that</span>
<span class="highlight-line">     * accepts a dish name (`String`) parameter.</span>
     */</span>
<span class="highlight-line">    <span class="token metadata symbol">@event</span> <span class="token keyword">function</span> <span class="token function">dishReady</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p class="extra-info">That's it: to add a custom event to an <code>Entity</code> subclass, you simply need to write a <code>function</code> declaration prefixed with the <code>@event</code> metadata like in the example above.</p>
<p>Under the hood, and thanks to the powerful Haxe macro system, Ceramic automatically generates methods at compile-time from this single <code>dishReady</code> event declaration. Here is what it will provide:</p>
<table>
    <tr>
        <td><code>onDishReady(owner, callback)</code></td>
    </tr>
    <tr>
        <td>Bind a <code>callback</code> that will be called everytime the <code>dishReady</code> event is fired.</td>
    </tr>
</table>
<table>
    <tr>
        <td><code>onceDishReady(owner, callback)</code></td>
    </tr>
    <tr>
        <td>Bind a <code>callback</code> that will be called one time, next time the <code>dishReady</code> event is fired (same as <code>onDishReady</code> except that the callback is garanteed to be called only once and then unbound).</td>
    </tr>
</table>
<table>
    <tr>
        <td><code>offDishReady(?callback)</code></td>
    </tr>
    <tr>
        <td>Unbind the given <code>callback</code> that was previously bound to the <code>dishReady</code> event, or unbind all callbacks bound to the <code>dishReady</code> event if no specific <code>callback</code> argument is provided.</td>
    </tr>
</table>
<table>
    <tr>
        <td><code>listensDishReady()</code></td>
    </tr>
    <tr>
        <td>Returns <code>true</code> if there is any callback bound and listening to the <code>dishReady</code> event, <code>false</code> otherwise.</td>
    </tr>
</table>
<table>
    <tr>
        <td><code>emitDishReady(name)</code></td>
    </tr>
    <tr>
        <td>Emit the <code>dishReady</code> event. This method is usually called from inside the class that have the event declaration.</td>
    </tr>
</table>
<p class="extra-info">You don't know what the <code>owner</code> argument is about yet? No worries, we'll get back to it just below!</p>
<p class="extra-info"><strong>Good to know:</strong> Because all these event-related methods are generated at compile time, they don't require dynamic access. Everything is statically typed and quite efficient. You can create and use a lot of events in Ceramic without worrying too much about performance penalties. Thanks Haxe and its compile-time macros!</p>
<h2 id="listening-to-an-event" tabindex="-1">Listening to an event <a class="header-anchor" href="#listening-to-an-event"><span aria-hidden="true" class="header-anchor__symbol">#</span></a></h2>
<p>Here we are, we have a <code>Kitchen</code> class with a <code>dishReady</code> event. Now, we still need to create a <code>Waiter</code> class that listens to the event from the <code>Kitchen</code> class.</p>
<p>Let's add this <code>Waiter</code> class with a constructor that takes a <code>kitchen</code> as parameter. It will listen to that kitchen and wait for <code>dishReady</code> events to be emitted.</p>
<div class="codename">Waiter.hx</div>
<pre class="language-haxe"><code class="language-haxe"><span class="highlight-line"><span class="token keyword">import</span> ceramic<span class="token punctuation">.</span>Entity<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token keyword">class</span> Waiter <span class="token keyword">extends</span> Entity <span class="token punctuation">{</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token keyword">new</span><span class="token punctuation">(</span>kitchen<span class="token punctuation">:</span>Kitchen<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token comment">// Listen to `dishReady` event and call</span></span>
<span class="highlight-line">        <span class="token comment">// `serveDish()` everytime the event is fired</span></span>
<span class="highlight-line">        kitchen<span class="token punctuation">.</span><span class="token function">onDishReady</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> serveDish<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token keyword">function</span> <span class="token function">serveDish</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span>String<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">'The waiter served the dish: '</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>Let's modify <code>Kitchen</code> class so that it will emit the <code>dishReady</code> event with a random dish name at a regular interval:</p>
<div class="codename">Kitchen.hx</div>
<pre class="language-haxe"><code class="language-haxe"><span class="highlight-line"><span class="token keyword">import</span> ceramic<span class="token punctuation">.</span>Entity<span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token keyword">import</span> ceramic<span class="token punctuation">.</span>Timer<span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token keyword">import</span> ceramic<span class="token punctuation">.</span>ReadOnlyArray<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token keyword">using</span> ceramic<span class="token punctuation">.</span>Extensions<span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token keyword">class</span> Kitchen <span class="token keyword">extends</span> Entity <span class="token punctuation">{</span></span>
<span class="highlight-line"></span>
    <span class="token comment">/**
<span class="highlight-line">     * A list of available dishes</span>
     */</span>
<span class="highlight-line">    <span class="token keyword">static</span> final AVAILABLE_DISHES<span class="token punctuation">:</span>ReadOnlyArray<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="highlight-line">        <span class="token string">'Pizza'</span><span class="token punctuation">,</span> <span class="token string">'Tiramisu'</span><span class="token punctuation">,</span> <span class="token string">'Pasta'</span><span class="token punctuation">,</span> <span class="token string">'Gelato'</span></span>
<span class="highlight-line">    <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
    <span class="token comment">/**
<span class="highlight-line">     * A custom `dishReady` event that</span>
<span class="highlight-line">     * accepts a dish name (`String`) parameter.</span>
     */</span>
<span class="highlight-line">    <span class="token metadata symbol">@event</span> <span class="token keyword">function</span> <span class="token function">dishReady</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
    <span class="token comment">/**
<span class="highlight-line">     * Constructor</span>
     */</span>
<span class="highlight-line">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line">        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token comment">// Finish a dish every 1 second</span></span>
<span class="highlight-line">        Timer<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> finishDish<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token keyword">function</span> <span class="token function">finishDish</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token comment">// Pick a dish name randomly</span></span>
<span class="highlight-line">        <span class="token keyword">var</span> name <span class="token operator">=</span> AVAILABLE_DISHES<span class="token punctuation">.</span><span class="token function">randomElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">        <span class="token comment">// Emit the `dishReady` event with that name</span></span>
<span class="highlight-line">        <span class="token function">emitDishReady</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"></span>
<span class="highlight-line">    <span class="token punctuation">}</span></span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<h3 id="about-this-and-the-owner-argument" tabindex="-1">About <code>this</code> and the <code>owner</code> argument <a class="header-anchor" href="#about-this-and-the-owner-argument"><span aria-hidden="true" class="header-anchor__symbol">#</span></a></h3>
<p>Why to we pass <code>this</code> as first argument of <code>kitchen.onDishReady(this, ...)</code>, as well as <code>Timer.interval(this, ...)</code>?</p>
<p>It is the <code>owner</code> argument: most methods provided by Ceramic API that take a callback as argument, which is expected to be called later, also accept a first argument: the <code>owner</code> of the binding. An <code>owner</code> is an <code>Entity</code> instance that <em>owns</em> the binding (here, a binding is an assignation of a callback to an event, a timer...). What does it mean in practice? It means that if that owner is <code>destroyed</code>, the binding is removed safely and automatically.</p>
<p>In our example with <code>kitchen.onDishReady(this, ...)</code>, if our <code>Waiter</code> instance (which is an <code>Entity</code> subclass) is <code>destroyed</code> (via the <code>destroy()</code> method), the binding to the <code>dishReady</code> event will be removed automatically. This mecanism ensures there won't be any memory leak because an entity is accidentally retained by another object. The binding will also be removed if the <code>kitchen</code> object is <code>destroyed</code>, not because it is the owner (it is not), but because it is the object emitting the event so destroying that object will remove any possibility of the <code>dishEvent</code> from being emitted anyway and make the related bindings irrelevant. It also prevents any risk of memory leak as well: the <code>kitchen</code> object won't be accidentally retained by the <code>Waiter</code> instance, thanks to the binding being safely removed.</p>
<p>Similar rules apply to the <code>Timer.interval(this, ...)</code> binding: if the <code>owner</code> (<code>this</code>) is <code>destroyed</code>, it will be unplugged from the <code>Timer</code> class safely and the callback won't be accidentally called.</p>
<p class="extra-info">In practice, the <code>owner</code> of a binding to an event, a timer etc... should be the object than contains the method that will be called as callback. It ensures that when the owner is <code>destroyed</code>, its methods won't be accidentally called later by a fired event from another object, everything is unplugged correctly and safely. You'll often simply use <code>this</code> as owner if your callback is a method of the current class anyway, like in our <code>Waiter</code> class example.</p>
<p>These rules might be a bit uneasy to grasp at first, but they are not very complicated. Don't hesitate to read the previous paragraphs again to understand correctly!</p>
<h3 id="better-together" tabindex="-1">Better together <a class="header-anchor" href="#better-together"><span aria-hidden="true" class="header-anchor__symbol">#</span></a></h3>
<p>Alright, we have a <code>Kitchen</code> and a <code>Waiter</code> class, but at the moment, nothing will happen until we instanciate and plug these objects together. let's do it:</p>
<pre class="language-haxe"><code class="language-haxe"><span class="highlight-line"><span class="token comment">// Nothing very difficult here,</span></span>
<span class="highlight-line"><span class="token comment">// We first create a kitchen</span></span>
<span class="highlight-line"><span class="token keyword">var</span> kitchen <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Kitchen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="highlight-line"><span class="token comment">// Then we create a waiter for that kitchen</span></span>
<span class="highlight-line"><span class="token keyword">var</span> waiter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Waiter</span><span class="token punctuation">(</span>kitchen<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>That is all! You can try to create this kitchen and waiter logic in a test project to see it work for real. If everything goes well, you should see logs similar to this appear at regular intervals:</p>
<pre class="language-text"><code class="language-text"><span class="highlight-line">The waiter served the dish: Pasta</span>
<span class="highlight-line">The waiter served the dish: Tiramisu</span>
<span class="highlight-line">The waiter served the dish: Tiramisu</span>
<span class="highlight-line">The waiter served the dish: Pizza</span></code></pre>
<p>To test the behaviour we explained in the <code>owner</code>/<code>this</code> section, you can try to destroy either the <code>kitchen</code> or the <code>waiter</code> object, after some time.
You should notice that the logs will stop as soon as one of the two objects of the binding is <code>destroyed</code>.</p>
<div class="codename">Destroy the kitchen after 10 seconds</div>
<pre class="language-haxe"><code class="language-haxe"><span class="highlight-line">Timer<span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span>kitchen<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> kitchen<span class="token punctuation">.</span>destroy<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<div class="codename">Destroy the waiter after 15 seconds</div>
<pre class="language-haxe"><code class="language-haxe"><span class="highlight-line">Timer<span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span>waiter<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> waiter<span class="token punctuation">.</span>destroy<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p class="extra-info">Look how we used the <code>owner</code> argument this time: the owner is the object having the method that will be called as callback by <code>Timer</code>, so the <code>owner</code> is the <code>kitchen</code> object if we bind the <code>destroy()</code> method from that <code>kitchen</code> object. It is the <code>waiter</code> object if we bind the <code>destroy()</code> method of that <code>waiter</code> object. In case the owner was destroyed before the timer delay has passed, the callback wouldn't be called at all. Basically, when you <code>destroy</code> an <code>entity</code>, you are sure that Ceramic events and timer bindings are removed and no method you previously assigned as callback will be called anymore!</p>
<p>You now know how to create <code>entities</code>, add custom events to them and make other entities listen to these events. Continue reading to learn more about the <code>Visual</code> class, an important type in Ceramic that inherits from <code>Entity</code> and provides its own built-in events.</p>

            
                
                        <hr />
                        <p>
                            Continue reading &#10132; <a href="/guides/visuals/">Visuals</a>
                        </p>
                        
            
            
            <hr />
            <div id="like-counter"></div>
            <script src="https://utteranc.es/client.js"
                repo="ceramic-engine/ceramic-comments"
                issue-term="pathname"
                theme="github-dark"
                crossorigin="anonymous"
                async>
            </script>
            
        </main>
    </div>
</div>
    </body>
</html>